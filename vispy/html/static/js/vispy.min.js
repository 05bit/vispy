/*!
* screenfull
* v1.2.0 - 2014-04-29
* (c) Sindre Sorhus; MIT License
*/

// console.log(c);

function get_pos(e,t){var n=e.getBoundingClientRect();return[t.clientX-n.left,t.clientY-n.top]}function normalize_pos(e,t){return[2*t[0]/e.width-1,1-2*t[1]/e.height]}function get_modifiers(e){var t=[];return e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),e.shiftKey&&t.push("shift"),t}function get_key(e){var t=null;return window.event?t=e.keyCode:e.which&&(t=e.which),t}function gen_mouse_event(e,t,n){if(e._eventinfo.is_button_pressed)var r=t.button;else r=null;var i=get_pos(e.$el.get(0),t),o=get_modifiers(t),u=e._eventinfo.press_event,a=(e._eventinfo.last_event,{type:n,pos:i,button:r,is_dragging:null!=u,modifiers:o,delta:null,press_event:u,last_event:null});return a}function gen_resize_event(e,t){var n={type:"resize",size:t};return n}function gen_paint_event(){var e={type:"paint"};return e}function gen_initialize_event(){var e={type:"initialize"};return e}function gen_key_event(e,t,n){var r=get_modifiers(t),i=(e._eventinfo.last_event,{type:n,modifiers:r,key:get_key(t),last_event:null});return i}function _events_can_be_combined(e,t){var n=e.type;return n==t.type&&"mouse_move"==n&&e.button==t.button&e.is_dragging==t.is_dragging&e.modifiers.equals(t.modifiers)?["pos"]:[]}function EventQueue(e){void 0==e&&(e=100),this._queue=[],this.maxlen=e}function init_app(e){e.$el.resize(function(t){e.resize([t.width(),t.height()])}),e.event_queue=new EventQueue,e._eventinfo={type:null,pos:null,button:null,is_dragging:null,key:null,modifiers:[],press_event:null,last_event:null,delta:null},e._eventinfo.is_button_pressed=0,e.$el.mousemove(function(t){var n=gen_mouse_event(e,t,"mouse_move");e._mouse_move(n),e.event_queue.append(n)}),e.$el.mousedown(function(t){++e._eventinfo.is_button_pressed;var n=gen_mouse_event(e,t,"mouse_release");e._mouse_press(n),e._eventinfo.press_event=n,e.event_queue.append(n)}),e.$el.mouseup(function(t){--e._eventinfo.is_button_pressed;var n=gen_mouse_event(e,t,"mouse_press");e._mouse_release(n),e._eventinfo.press_event=null,e.event_queue.append(n)}),e.$el.click(function(){e._eventinfo.press_event=null}),e.$el.dblclick(function(){e._eventinfo.press_event=null}),void 0!=e.$el.mousewheel&&e.$el.mousewheel(function(t){var n=gen_mouse_event(e,t,"mouse_wheel");n.delta=[t.wheelDeltaX/100,t.wheelDeltaY/100],e._mouse_wheel(n),e.event_queue.append(n)}),e.$el.keypress(function(t){var n=gen_key_event(e,t,"key_press");e._key_press(n),e.event_queue.append(n)}),e.$el.keyup(function(t){var n=gen_key_event(e,t,"key_release");e._key_release(n),e.event_queue.append(n)}),e.$el.keydown(function(){}),e.$el.mouseout(function(){})}function viewport(e){e.gl.viewport(0,0,e.width(),e.height())}function clear(e,t){e.gl.clearColor(t[0],t[1],t[2],t[3]),e.gl.clear(e.gl.COLOR_BUFFER_BIT)}function compile_shader(e,t,n){n="precision mediump float;\n"+n,n=n.replace(/\\n/g,"\n");var r=e.gl.createShader(e.gl[t]);return e.gl.shaderSource(r,n),e.gl.compileShader(r),e.gl.getShaderParameter(r,e.gl.COMPILE_STATUS)?r:(console.error(e.gl.getShaderInfoLog(r)),null)}function attach_shaders(e,t,n,r){e.gl.attachShader(t,n),e.gl.attachShader(t,r),e.gl.linkProgram(t),e.gl.getProgramParameter(t,e.gl.LINK_STATUS)||console.warn("Could not initialise shaders on program '{0}'.".format(t))}function create_attribute(e,t,n){var r=e.gl.getAttribLocation(t,n);return r}function activate_attribute(e,t,n,r,i,o){var u=get_attribute_info(r),a=u[0],s=u[1];_vbo_info=e._ns[n];var l=_vbo_info.handle;e.gl.enableVertexAttribArray(t),e.gl.bindBuffer(e.gl.ARRAY_BUFFER,l),e.gl.vertexAttribPointer(t,s,e.gl[a],!1,i,o)}function deactivate_attribute(e,t){e.gl.disableVertexAttribArray(t)}function activate_texture(e,t,n,r){e.gl.activeTexture(e.gl.TEXTURE0+r),e.gl.bindTexture(e.gl.TEXTURE_2D,t)}function set_texture_data(e,t,n,r,i,o,u){e.gl.bindTexture(n,t),e.gl.texImage2D(n,0,r,i,o,0,r,e.gl.UNSIGNED_BYTE,u)}function set_buffer_data(e,t,n,r,i,o){e.gl.bindBuffer(n,t),o?e.gl.bufferSubData(n,r,i):e.gl.bufferData(n,i,e.gl.STATIC_DRAW)}function set_uniform(e,t,n,r){array=to_typed_array(r),n.indexOf("Matrix")>0?e.gl[n](t,!1,array):e.gl[n](t,array)}function get_attribute_info(e){var t="FLOAT";("i"==e[0]||"int"==e)&&(t="INT");var n;return n="int"==e||"float"==e?1:parseInt(e.slice(-1)),[t,n]}function get_uniform_function(e){var t,n;t="i"==e[0]||"int"==e?"i":"f";var n;return n="int"==e||"float"==e?1:parseInt(e.slice(-1)),"uniform{0}{1}v".format(n,t)}function get_gl_type(e){return _gl_type_map[e]}function parse_enum(e,t){for(var n=t.split("|"),r=0,i=0;i<n.length;i++){var o=n[i].toUpperCase().trim();r|=e.gl[o]}return r}function GlirQueue(){this._queue=[]}function init_webgl(e){var t=e.$el.get(0);e.gl=t.getContext("webgl")||t.getContext("experimental-webgl")}function is_array(e){return"[object Array]"===Object.prototype.toString.call(e)}function debug(e){VISPY_DEBUG&&console.debug(e)}function to_typed_array(e){var t=e.storage_type;if(void 0==t)return e;var n=e.data_type,r=e.buffer;return"javascript_array"==t?_typed_array_map[n](r):"javascript_typed_array"==t?r:void 0}function VispyCanvas(e){this.$el=e}!function(){var e="undefined"!=typeof module&&module.exports,t="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,n=function(){for(var e,t,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};i>r;r++)if(e=n[r],e&&e[1]in document){for(r=0,t=e.length;t>r;r++)o[n[0][r]]=e[r];return o}return!1}(),r={request:function(e){var r=n.requestFullscreen;e=e||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?e[r]():e[r](t&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[n.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(){},onerror:function(){},raw:n};return n?(Object.defineProperties(r,{isFullscreen:{get:function(){return!!document[n.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[n.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[n.fullscreenEnabled]}}}),document.addEventListener(n.fullscreenchange,function(e){r.onchange.call(r,e)}),document.addEventListener(n.fullscreenerror,function(e){r.onerror.call(r,e)}),void(e?module.exports=r:window.screenfull=r)):void(e?module.exports=!1:window.screenfull=!1)}(),define("screenfull",function(){}),VispyCanvas.prototype._mouse_press=function(){},VispyCanvas.prototype._mouse_release=function(){},VispyCanvas.prototype._mouse_move=function(){},VispyCanvas.prototype._mouse_wheel=function(){},VispyCanvas.prototype._mouse_click=function(){},VispyCanvas.prototype._mouse_dblclick=function(){},VispyCanvas.prototype._key_press=function(){},VispyCanvas.prototype._key_release=function(){},VispyCanvas.prototype._initialize=function(){},VispyCanvas.prototype._resize=function(){},VispyCanvas.prototype._paint=function(){},VispyCanvas.prototype.on_mouse_press=function(e){this._mouse_press=e},VispyCanvas.prototype.on_mouse_release=function(e){this._mouse_release=e},VispyCanvas.prototype.on_mouse_move=function(e){this._mouse_move=e},VispyCanvas.prototype.on_mouse_wheel=function(e){this._mouse_wheel=e},VispyCanvas.prototype.on_mouse_dblclick=function(e){this._mouse_dblclick=e},VispyCanvas.prototype.on_key_press=function(e){this._key_press=e},VispyCanvas.prototype.on_key_release=function(e){this._key_release=e},VispyCanvas.prototype.on_initialize=function(e){this._initialize=e},VispyCanvas.prototype.on_resize=function(e){this._resize=e},VispyCanvas.prototype.on_paint=function(e){this._paint=e},VispyCanvas.prototype.initialize=function(){var e=gen_initialize_event(this);this._set_size(),this._initialize(e)},VispyCanvas.prototype._set_size=function(e){return void 0==e&&(e=[this.$el.width(),this.$el.height()]),this.size=e,this.width=e[0],this.height=e[1],e},VispyCanvas.prototype.paint=function(){var e=gen_paint_event(this);this._paint(e)},VispyCanvas.prototype.update=VispyCanvas.prototype.paint,VispyCanvas.prototype.resize=function(e){e=this._set_size(e);var t=gen_resize_event(this,e);this.gl.canvas.width=e[0],this.gl.canvas.height=e[1],this._resize(t)},VispyCanvas.prototype.toggle_fullscreen=function(){screenfull.enabled&&(screenfull.isFullscreen?(screenfull.exit(),this.resize(this._size)):(this._size=[this.$el.width(),this.$el.height()],screenfull.request(this.$el[0]),this.resize([screen.width,screen.height])))},VispyCanvas.prototype.resizable=function(){var e=this;this.$el.resizable({resize:function(t,n){e.resize([n.size.width,n.size.height])}})},EventQueue.prototype.clear=function(){this._queue=[]},EventQueue.prototype.append=function(e,t){var n=!0;if(void 0==t&&(t=!0),t){var r=this._queue[this._queue.length-1];if(void 0!=r){var i=_events_can_be_combined(e,r);if(i.length>0){for(var o=0;o<i.length;o++){var u=i[o];this._queue[this._queue.length-1][u]=e[u]}n=!1}}}n&&this._queue.push(e),this._queue.length>this.maxlen&&(this._queue.shift(),this._queue[0].last_event=null)},EventQueue.prototype.get=function(){return this._queue},Object.defineProperty(EventQueue.prototype,"length",{get:function(){return this._queue.length}}),VispyCanvas.prototype.start_event_loop=function(e){if(!this._deferred)return console.warn("start_event_loop() has no effect when deferred mode is disabled."),!1;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var t=this;!function n(){requestAnimFrame(n),t.execute_pending_commands(),void 0!=e&&e()}()},define("events",["screenfull"],function(){var e=function(){};return e.prototype.init=function(e){init_app(e)},new e});var _gl_type_map={VertexBuffer:"ARRAY_BUFFER",IndexBuffer:"ELEMENT_ARRAY_BUFFER",Texture2D:"TEXTURE_2D"};GlirQueue.prototype.clear=function(){this._queue=[]},GlirQueue.prototype.append=function(e){this._queue.push(e)},GlirQueue.prototype.append_multi=function(e){for(var t=0;t<e.length;t++)this._queue.push(e[t])},GlirQueue.prototype.get=function(){return this._queue},Object.defineProperty(GlirQueue.prototype,"length",{get:function(){return this._queue.length}}),VispyCanvas.prototype.set_deferred=function(e){this._deferred=e},VispyCanvas.prototype.execute_pending_commands=function(){var e=this.glir_queue.get();if(0!=e.length){for(var t=0;t<e.length;t++)this.call(e[t],!1);debug("Processed {0} events.".format(e.length)),this.glir_queue.clear()}},define("gloo.glir",[],function(){var e=function(){var e=this;VispyCanvas.prototype.call=function(t,n){void 0==n&&(n=this._deferred);var r=t[0].toLowerCase();n?this.glir_queue.append(t):e[r](this,t.slice(1))}};return e.prototype.init=function(e){e._ns={},e._deferred=!VISPY_DEBUG,e.glir_queue=new GlirQueue},e.prototype.create=function(e,t){var n=t[0],r=t[1];"VertexBuffer"==r?(debug("Creating vertex buffer '{0}'.".format(n)),e._ns[n]={object_type:r,handle:e.gl.createBuffer(),size:0}):"IndexBuffer"==r?(debug("Creating index buffer '{0}'.".format(n)),e._ns[n]={object_type:r,handle:e.gl.createBuffer(),size:0}):"Texture2D"==r?(debug("Creating texture '{0}'.".format(n)),e._ns[n]={object_type:r,handle:e.gl.createTexture(),size:0,shape:[]}):"Program"==r&&(debug("Creating program '{0}'.".format(n)),e._ns[n]={object_type:r,handle:e.gl.createProgram(),attributes:{},uniforms:{},textures:{}})},e.prototype.delete=function(e,t){var n=t[0],r=e._ns[n].object_type,i=e._ns[n].handle;"VertexBuffer"==r?(debug("Deleting vertex buffer '{0}'.".format(n)),e.gl.deleteBuffer(i)):"IndexBuffer"==r?(debug("Deleting index buffer '{0}'.".format(n)),e.gl.deleteBuffer(i)):"Texture2D"==r?(debug("Deleting texture '{0}'.".format(n)),e.gl.deleteTexture(i)):"Program"==r&&(debug("Deleting program '{0}'.".format(n)),e.gl.deleteProgram(i))},e.prototype.shaders=function(e,t){var n=t[0],r=t[1],i=t[2],o=e._ns[n].handle;debug("Compiling shaders for program '{0}'.".format(n));var u=compile_shader(e,"VERTEX_SHADER",r),a=compile_shader(e,"FRAGMENT_SHADER",i);debug("Attaching shaders for program '{0}'".format(n)),attach_shaders(e,o,u,a)},e.prototype.size=function(e,t){var n=t[0],r=t[1],i=t[2],o=e._ns[n],u=o.handle,a=o.object_type,s=e.gl[get_gl_type(a)];a.indexOf("Texture")>=0?(o.format=i.toUpperCase(),debug("Setting texture size to {1} for '{0}'.".format(n,r))):(debug("Setting buffer size to {1} for '{0}'.".format(n,r)),set_buffer_data(e,u,s,0,r,!1)),o.size=r},e.prototype.data=function(e,t){var n=t[0],r=t[1],i=t[2],o=i.length,u=e._ns[n],a=u.object_type,s=u.handle,l=e.gl[get_gl_type(a)],f=to_typed_array(i);if(a.indexOf("Texture")>=0){var _=u.size,p=_[0],c=_[1],g=e.gl[u.format];debug("Setting texture data for '{0}'.".format(n)),set_texture_data(e,s,l,g,p,c,f),u.shape=_}else debug("Setting buffer data for '{0}'.".format(n)),set_buffer_data(e,s,l,r,f,u.size>0),u.size=o},e.prototype.attribute=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],u=t[4],a=t[5],s=e._ns[n].handle;debug("Creating attribute '{0}' for program '{1}'.".format(r,n));var l=create_attribute(e,s,r);e._ns[n].attributes[r]={handle:l,type:i,vbo_id:o,stride:u,offset:a}},e.prototype.uniform=function(e,t){var n=t[0],r=t[1],i=t[2],o=t[3],u=e._ns[n].handle;if(e.gl.useProgram(u),void 0==e._ns[n].uniforms[r]){debug("Creating uniform '{0}' for program '{1}'.".format(r,n));var a=e.gl.getUniformLocation(u,r),s=get_uniform_function(i);e._ns[n].uniforms[r]=[a,s]}debug("Setting uniform '{0}' to '{1}' with {2} elements.".format(r,o,o.length));var l=e._ns[n].uniforms[r],a=l[0],s=l[1];set_uniform(e,a,s,o)},e.prototype.texture=function(e,t){var n=t[0],r=t[1],i=t[2],o=e._ns[i].handle,u=e._ns[n].handle,a=Object.keys(e._ns[n].textures).length;debug("Initializing texture '{0}' number {1} for program '{2}'.".format(i,a,n));var s=e.gl.getUniformLocation(u,r);e.gl.uniform1i(s,a),e._ns[n].textures[i]={sampler_name:r,sampler_handle:s,number:a,handle:o}},e.prototype.interpolation=function(e,t){var n=t[0],r=t[1],i=t[2],o=e._ns[n].handle,u=e.gl.TEXTURE_2D;e.gl.bindTexture(u,o),e.gl.texParameteri(u,e.gl.TEXTURE_MIN_FILTER,e.gl[r]),e.gl.texParameteri(u,e.gl.TEXTURE_MAG_FILTER,e.gl[i]),e.gl.bindTexture(u,null)},e.prototype.wrapping=function(e,t){var n=t[0],r=t[1],i=e._ns[n].handle,o=e.gl.TEXTURE_2D;e.gl.bindTexture(o,i),e.gl.texParameteri(o,e.gl.TEXTURE_WRAP_S,e.gl[r[0]]),e.gl.texParameteri(o,e.gl.TEXTURE_WRAP_T,e.gl[r[1]]),e.gl.bindTexture(o,null)},e.prototype.draw=function(e,t){var n=t[0],r=t[1],i=t[2],o=e._ns[n].handle,u=e._ns[n].attributes,a=e._ns[n].textures;for(attribute_name in u){var s=u[attribute_name];debug("Activating attribute '{0}' for program '{1}'.".format(attribute_name,n)),activate_attribute(e,s.handle,s.vbo_id,s.type,s.stride,s.offset)}for(texture_id in a){var l=a[texture_id];debug("Activating texture '{0}' for program '{1}'.".format(texture_id,n)),activate_texture(e,l.handle,l.sampler_handle,l.number)}if(e.gl.useProgram(o),2==i.length){var f=i[0],_=i[1];debug("Rendering program '{0}' with {1}.".format(n,r)),e.gl.drawArrays(e.gl[r],f,_)}else if(3==i.length){var p=i[0],c=i[1],_=i[2],g=e._ns[p].handle;debug("Rendering program '{0}' with {1} and index buffer '{2}'.".format(n,r,p)),e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,g),e.gl.drawElements(e.gl[r],_,e.gl[c],0)}for(attribute_name in u)debug("Deactivating attribute '{0}' for program '{1}'.".format(attribute_name,n)),deactivate_attribute(e,u[attribute_name].handle)},e.prototype.func=function(e,t){var n=t[0];debug("Calling {0}({1}).".format(n,t.slice(1)));for(var r=1;r<t.length;r++)"string"==typeof t[r]&&(t[r]=parse_enum(e,t[r]));var i=e.gl[n],o=t.slice(1);i.apply(e.gl,o)},new e}),define("gloo",["gloo.glir"],function(e){var t=function(){this.glir=e};return t.prototype.init=function(e){init_webgl(e),this.glir.init(e)},new t}),String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return"undefined"!=typeof e[n]?e[n]:t})}),Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,n=this.length;n>t;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0};var VISPY_DEBUG=!1;define("util",function(){});var _typed_array_map={float32:Float32Array,int8:Int8Array,int16:Int16Array,int32:Int32Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array};define("data",function(){}),require.config({paths:{screenfull:"lib/screenfull.min"}}),define("vispy",["events","gloo","util","data"],function(e,t){var n=function(){this.events=e,this.gloo=t};return n.prototype.init=function(e){var t;t="string"==typeof e?$(e):e;var n=new VispyCanvas(t);return this.events.init(n),this.gloo.init(n),n},new n});